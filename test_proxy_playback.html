<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>音乐代理测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        audio {
            width: 100%;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>音乐代理播放测试</h1>
    
    <div class="test-section">
        <h2>测试1: 直接使用网易云链接</h2>
        <p>预期：可能无法播放（防盗链限制）</p>
        <audio controls>
            <source src="http://music.163.com/song/media/outer/url?id=254059" type="audio/mpeg">
            您的浏览器不支持音频播放。
        </audio>
    </div>
    
    <div class="test-section">
        <h2>测试2: 使用我们的代理链接</h2>
        <p>预期：应该可以正常播放</p>
        <audio controls>
            <source src="http://localhost:5000/proxy-music?url=http%3A%2F%2Fmusic.163.com%2Fsong%2Fmedia%2Fouter%2Furl%3Fid%3D254059" type="audio/mpeg">
            您的浏览器不支持音频播放。
        </audio>
    </div>
    
    <script>
        // 测试音频元素的事件
        const audioElements = document.querySelectorAll('audio');
        
        audioElements.forEach((audio, index) => {
            audio.addEventListener('error', (e) => {
                console.error(`音频测试${index + 1}错误:`, e.target.error);
            });
            
            audio.addEventListener('loadedmetadata', () => {
                console.log(`音频测试${index + 1}加载成功，时长: ${audio.duration}秒`);
            });
            
            audio.addEventListener('play', () => {
                console.log(`音频测试${index + 1}开始播放`);
            });
        });
    </script>
</body>
</html>